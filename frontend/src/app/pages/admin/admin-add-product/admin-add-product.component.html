<!-- frontend/src/app/pages/admin/admin-add-product/admin-add-product.component.html -->
<div class="container-fluid p-4">
  <p-toast />
  
  <!-- Header -->
  <div class="flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="text-3xl font-bold text-color">{{ pageTitle | translate }}</h1>
      <p class="text-color-secondary mt-2">
        {{ (isEditMode() ? 'admin.products.edit_product' : 'admin.products.add_product') | translate }}
      </p>
    </div>
    
    <p-button 
      [label]="'common.back' | translate"
      icon="pi pi-arrow-left" 
      severity="secondary" 
      (onClick)="onCancel()"
      size="small"
    />
  </div>

  <!-- Form Card -->
  <p-card styleClass="mb-4">
    <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
      
      <!-- Basic Information Section -->
      <div class="section-title">
        <i class="pi pi-info-circle mr-2"></i>
        {{ 'admin.products.form.basic_info' | translate }}
      </div>
      
      <!-- Translations Section -->
      <div class="section-title">
        <i class="pi pi-globe mr-2"></i>
        {{ 'admin.products.form.translations' | translate }}
      </div>
      
      <div class="grid">
        <!-- English Name -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
              {{ 'admin.products.form.english_name' | translate }} *
            </label>
            <input 
              pInputText 
              formControlName="name_en"
              [placeholder]="'admin.products.form.english_name' | translate"
              class="w-full"
              [class.ng-invalid]="productForm.get('name_en')?.invalid && productForm.get('name_en')?.touched"
            />
            <small 
              *ngIf="productForm.get('name_en')?.invalid && productForm.get('name_en')?.touched" 
              class="p-error block mt-1"
            >
              <span *ngIf="productForm.get('name_en')?.errors?.['required']">
                {{ 'admin.products.form.name_required' | translate }}
              </span>
              <span *ngIf="productForm.get('name_en')?.errors?.['minlength']">
                {{ 'admin.products.form.name_minlength' | translate }}
              </span>
            </small>
          </div>
        </div>

        <!-- French Name -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡«ðŸ‡·</span>
              {{ 'admin.products.form.french_name' | translate }} *
            </label>
            <input 
              pInputText 
              formControlName="name_fr"
              [placeholder]="'admin.products.form.french_name' | translate"
              class="w-full"
              [class.ng-invalid]="productForm.get('name_fr')?.invalid && productForm.get('name_fr')?.touched"
            />
            <small 
              *ngIf="productForm.get('name_fr')?.invalid && productForm.get('name_fr')?.touched" 
              class="p-error block mt-1"
            >
              <span *ngIf="productForm.get('name_fr')?.errors?.['required']">
                {{ 'admin.products.form.name_required' | translate }}
              </span>
              <span *ngIf="productForm.get('name_fr')?.errors?.['minlength']">
                {{ 'admin.products.form.name_minlength' | translate }}
              </span>
            </small>
          </div>
        </div>

        <!-- Arabic Name -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡©ðŸ‡¿</span>
              {{ 'admin.products.form.arabic_name' | translate }} *
            </label>
            <input 
              pInputText 
              formControlName="name_ar"
              [placeholder]="'admin.products.form.arabic_name' | translate"
              class="w-full"
              [class.ng-invalid]="productForm.get('name_ar')?.invalid && productForm.get('name_ar')?.touched"
            />
            <small 
              *ngIf="productForm.get('name_ar')?.invalid && productForm.get('name_ar')?.touched" 
              class="p-error block mt-1"
            >
              <span *ngIf="productForm.get('name_ar')?.errors?.['required']">
                {{ 'admin.products.form.name_required' | translate }}
              </span>
              <span *ngIf="productForm.get('name_ar')?.errors?.['minlength']">
                {{ 'admin.products.form.name_minlength' | translate }}
              </span>
            </small>
          </div>
        </div>
      </div>

      <!-- Description Translations -->
      <div class="grid mt-3">
        <!-- English Description -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
              {{ 'admin.products.form.english_description' | translate }}
            </label>
            <textarea 
              pInputTextarea 
              formControlName="description_en"
              [placeholder]="'admin.products.form.english_description' | translate"
              rows="3"
              class="w-full"
            ></textarea>
          </div>
        </div>

        <!-- French Description -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡«ðŸ‡·</span>
              {{ 'admin.products.form.french_description' | translate }}
            </label>
            <textarea 
              pInputTextarea 
              formControlName="description_fr"
              [placeholder]="'admin.products.form.french_description' | translate"
              rows="3"
              class="w-full"
            ></textarea>
          </div>
        </div>

        <!-- Arabic Description -->
        <div class="col-12 md:col-4">
          <div class="language-section">
            <label class="font-semibold text-900 block mb-2">
              <span class="language-flag">ðŸ‡©ðŸ‡¿</span>
              {{ 'admin.products.form.arabic_description' | translate }}
            </label>
            <textarea 
              pInputTextarea 
              formControlName="description_ar"
              [placeholder]="'admin.products.form.arabic_description' | translate"
              rows="3"
              class="w-full"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Translation Help Note -->
      <div class="mt-3 p-3 border-1 border-300 border-round surface-50">
        <small class="text-600">
          <i class="pi pi-info-circle mr-2"></i>
          {{ 'admin.products.form.translation_help' | translate }}
        </small>
      </div>

      <!-- Pricing & Inventory Section -->
      <div class="section-title">
        <i class="pi pi-dollar mr-2"></i>
        {{ 'admin.products.form.pricing_inventory' | translate }}
      </div>
      
      <div class="grid">
        <!-- Price -->
        <div class="col-12 md:col-4">
          <div class="field">
            <label class="font-semibold text-900 block mb-2">
              {{ 'admin.products.form.price' | translate }} *
            </label>
            <p-inputNumber
              formControlName="price"
              mode="currency"
              currency="EUR"
              locale="fr-FR"
              [placeholder]="'admin.products.form.price' | translate"
              styleClass="w-full"
              [class.ng-invalid]="productForm.get('price')?.invalid && productForm.get('price')?.touched"
            />
            <small 
              *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched" 
              class="p-error block mt-1"
            >
              <span *ngIf="productForm.get('price')?.errors?.['required']">
                {{ 'admin.products.form.price_required' | translate }}
              </span>
              <span *ngIf="productForm.get('price')?.errors?.['min']">
                {{ 'admin.products.form.price_min' | translate }}
              </span>
            </small>
          </div>
        </div>

        <!-- Unit -->
        <div class="col-12 md:col-4">
          <div class="field">
            <label class="font-semibold text-900 block mb-2">
              {{ 'admin.products.form.unit' | translate }} *
            </label>
            <p-select
              formControlName="unit"
              [options]="getUnitOptions()"
              optionLabel="label"
              optionValue="value"
              [placeholder]="'admin.products.form.unit' | translate"
              styleClass="w-full"
              [class.ng-invalid]="productForm.get('unit')?.invalid && productForm.get('unit')?.touched"
            />
            <small 
              *ngIf="productForm.get('unit')?.invalid && productForm.get('unit')?.touched" 
              class="p-error block mt-1"
            >
              {{ 'admin.products.form.unit_required' | translate }}
            </small>
          </div>
        </div>

        <!-- Stock Quantity -->
        <div class="col-12 md:col-4">
          <div class="field">
            <label class="font-semibold text-900 block mb-2">
              {{ 'admin.products.form.stock_quantity' | translate }} *
            </label>
            <p-inputNumber
              formControlName="stock_quantity"
              [placeholder]="'admin.products.form.stock_quantity' | translate"
              styleClass="w-full"
              [class.ng-invalid]="productForm.get('stock_quantity')?.invalid && productForm.get('stock_quantity')?.touched"
            />
            <small 
              *ngIf="productForm.get('stock_quantity')?.invalid && productForm.get('stock_quantity')?.touched" 
              class="p-error block mt-1"
            >
              <span *ngIf="productForm.get('stock_quantity')?.errors?.['required']">
                {{ 'admin.products.form.stock_required' | translate }}
              </span>
              <span *ngIf="productForm.get('stock_quantity')?.errors?.['min']">
                {{ 'admin.products.form.stock_min' | translate }}
              </span>
            </small>
          </div>
        </div>
      </div>

      <!-- Category -->
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="field">
            <label class="font-semibold text-900 block mb-2">
              {{ 'admin.products.form.category' | translate }} *
            </label>
            <p-select
              formControlName="category_id"
              [options]="categoryOptions()"
              optionLabel="label"
              optionValue="value"
              [placeholder]="'admin.products.form.category' | translate"
              styleClass="w-full"
              [loading]="categoriesLoading()"
              [class.ng-invalid]="productForm.get('category_id')?.invalid && productForm.get('category_id')?.touched"
            />
            <small 
              *ngIf="productForm.get('category_id')?.invalid && productForm.get('category_id')?.touched" 
              class="p-error block mt-1"
            >
              {{ 'admin.products.form.category_required' | translate }}
            </small>
          </div>
        </div>

        <!-- Image URL -->
        <div class="col-12 md:col-6">
          <div class="field">
            <label class="font-semibold text-900 block mb-2">
              {{ 'admin.products.form.image_url' | translate }}
            </label>
            <input 
              pInputText 
              formControlName="image_url"
              [placeholder]="'admin.products.form.image_placeholder' | translate"
              class="w-full"
            />
          </div>
        </div>
      </div>

      <!-- Settings Section -->
      <div class="section-title">
        <i class="pi pi-cog mr-2"></i>
        {{ 'admin.products.form.settings' | translate }}
      </div>
      
      <div class="grid">
        <!-- Organic Product -->
        <div class="col-12 md:col-6">
          <div class="field">
            <div class="flex align-items-center">
              <p-checkbox 
                formControlName="is_organic" 
                binary="true" 
                inputId="is_organic"
              />
              <label for="is_organic" class="ml-2 font-semibold text-900">
                {{ 'admin.products.form.is_organic' | translate }}
              </label>
            </div>
          </div>
        </div>

        <!-- Active Product -->
        <div class="col-12 md:col-6">
          <div class="field">
            <div class="flex align-items-center">
              <p-checkbox 
                formControlName="is_active" 
                binary="true" 
                inputId="is_active"
              />
              <label for="is_active" class="ml-2 font-semibold text-900">
                {{ 'admin.products.form.is_active' | translate }}
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-content-end gap-2 mt-4 pt-4 border-top-1 surface-border">
        <p-button 
          [label]="'admin.products.form.cancel' | translate"
          severity="secondary" 
          (onClick)="onCancel()"
          [disabled]="loading()"
        />
        
        <p-button 
          type="submit"
          [label]="submitButtonLabel | translate"
          [loading]="loading()"
          [disabled]="productForm.invalid"
        />
      </div>
    </form>
  </p-card>
</div>